<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:09816cfc-2cfc-4d80-84c8-01e141e93e2a -->
<metadata name="vp_Chart4_Invoices" path="/shared/Publish/Control_And_Reconciliation/vp_Chart4_Invoices" type="TABLE" subtype="SQL_TABLE" changeToken="0" tableType="VIEW">
  <columns>
    <column name="Run_Number" nullable="true">
      <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Percent_Of_Total_Numbr_Of_records_In_TDS" nullable="true">
      <datatype type="DECIMAL" maxDigits="38" maxFractionalDigits="6"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Function_Long_Description" nullable="true">
      <datatype type="STRING" maxLength="255"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Run_Day_Sort" nullable="true">
      <datatype type="INTEGER" minValue="-128" maxValue="127"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Category_Label" nullable="true">
      <datatype type="STRING" minLength="1" trailingSpaces="false"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Run_Type_Code" nullable="true">
      <datatype type="STRING" minLength="1" maxLength="1" trailingSpaces="false"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Invoice_Unmatched_Indicator" nullable="true">
      <datatype type="INTEGER" minValue="0" maxValue="1"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
  </columns>
  <indexes></indexes>
  <foreignKeys></foreignKeys>
  <security>
    <owner user="x423xjm" domain="tntadtest"/>
    <privilege user="x423xjm" domain="tntadtest" privileges="READ WRITE"/>
  </security>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_MODULE_NM">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="BUS_MODULE_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="PJP_SLR_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_MOD_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_TOTREF_NR" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="FNC_SORT_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="FNC_SHORT_DS" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="FNC_LONG_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="DTE_YRWK_NR" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="COU_ID" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="CM_RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="FNC_SOURCE_CD" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="JCL_RUN_DAY_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="EDW_RECORD_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_PIECE_QT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_CONS_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_KILOS_WT">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
      <element name="EDW_REVENUE_AM">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="MRN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_SEQ_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_UPDT_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_UPDT_USER_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="MRN_LATESTRUN_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRT_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MCF_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_STATUS_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_START_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_END_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ACTUALRUN_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_NM" nullable="false">
        <datatype type="STRING" minLength="40" maxLength="40"/>
      </element>
      <element name="MRN_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
      <element name="CPP_PERIOD_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="ENV_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_OUTPUT_STAT_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="CPP_OUTPUT_VER_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ID_QCFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JOB_JOB_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="JOB_SCHDULED_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="JOB_CONDITIONAL_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="IA_INV_ACC_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="GRP_CD" nullable="false">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JCL_RUN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="JOB_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_RUN_DAY_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_START_TD" nullable="false">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_PROCESS_WK_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_PROCESS_YR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_END_TD">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_RUNTIME_CPU_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_RUNTIME_EPS_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_UPDATE_TS" nullable="false">
        <datatype type="DATETIME"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/TNTCALDAYSDIFF_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="DTE_DT" nullable="false">
        <datatype type="DATE"/>
      </element>
      <element name="TNT_WK">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
      <element name="TNT_MTH">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
      <element name="TNT_QTR">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="TNT_YR">
        <datatype type="STRING" minLength="4" maxLength="4"/>
      </element>
      <element name="DAYS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="WKS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MTHS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="QTRS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="YRS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <attribute name="SQL" type="STRING">select 
MasterIdentityRows.Run_Number,
(cast(MasterIdentityRows.Number_of_Records as decimal(32,8))/cast(TotalSDSRecords.Total_SDS_Records as decimal(32,8))) as Percent_Of_Total_Numbr_Of_records_In_TDS,
MasterIdentityRows.Function_Long_Description,
MasterIdentityRows.Run_Day_Sort,
MasterIdentityRows.Category_Label,
MasterIdentityRows.Run_Type_Code,
CASE
  WHEN MasterIdentityRows.Function_Long_Description = &apos;Invoice Unmatched&apos;
    THEN 1
  ELSE 0
END   as Invoice_Unmatched_Indicator
 from  
(select distinct CM_COSTINGRUN_V01.MRN_ID Run_Number,
case when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;6.2.1.4&apos;,&apos;6.2.1.5&apos;,&apos;6.2.2.1&apos;) 
 then &apos;G&apos; when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;7.2.1.4&apos;,&apos;7.2.1.5&apos;,&apos;7.2.2.1&apos;)
 then &apos;1&apos; else &apos;U&apos; end as Run_Type_Code,

 CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS Function_Short_Description,
 sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) over (partition by  CM_COSTINGRUN_V01.MRN_ID, CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS, CM_CNTRL_METRICS_DESC_V01.FNC_LONG_DS, trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || 
 (case  when substring (trim(both from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ), 
 (case when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ), 
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), 
 trim(both from CM_COSTINGRUN_V01.MRN_ID) || (case  when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;7.2.1.4&apos;,&apos;7.2.1.5&apos;,&apos;7.2.2.1&apos;) then &apos; &apos; else &apos; &apos; || (case when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end)) Number_of_Records,
 CM_CNTRL_METRICS_DESC_V01.FNC_LONG_DS Function_Long_Description,
 trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Run_Week,
 (case when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos;  
 else &apos;Sun&apos; end ) Run_Day,
 (case when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 
 else 1 end ) Run_Day_Sort,
 trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || 
 (case  when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;7.2.1.4&apos;,&apos;7.2.1.5&apos;,&apos;7.2.2.1&apos;) then &apos; &apos; else &apos; &apos; ||
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) end ) || 
 (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 
 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 
 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) 
 on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where 
 CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos;	and case when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;6.2.1.4&apos;,&apos;6.2.1.5&apos;,&apos;6.2.2.1&apos;) 
 then &apos;G&apos; when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS in (&apos;7.2.1.4&apos;,&apos;7.2.1.5&apos;,&apos;7.2.2.1&apos;)
 then &apos;1&apos; else &apos;U&apos; end in (&apos;G&apos;,&apos;1&apos;)
  )MasterIdentityRows 
 

inner join 



(select distinct CM_COSTINGRUN_V01.MRN_ID Run_Number ,
case when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;6.2&apos; 
 then &apos;G&apos; 
 when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;7.2&apos;
then &apos;1&apos; else &apos;U&apos; end as Run_Type_Code,
 CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS Function_Short_Description ,
 sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) over(partition by CM_COSTINGRUN_V01.MRN_ID,
 CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS,
 CM_CNTRL_METRICS_DESC_V01.FNC_LONG_DS,
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ),
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 7 end ),
 trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;,&apos;09&apos;,&apos;13&apos;,&apos;18&apos;,&apos;22&apos;,&apos;26&apos;,&apos;31&apos;,&apos;35&apos;,&apos;39&apos;,&apos;44&apos;,&apos;48&apos;,&apos;52&apos;) then &apos;*&apos; else &apos; &apos; end )) Total_SDS_Records ,
 CM_CNTRL_METRICS_DESC_V01.FNC_LONG_DS Function_Long_Description ,
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) Run_Day ,
 (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 7 end ) Run_Day_Number ,
 trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;,&apos;09&apos;,&apos;13&apos;,&apos;18&apos;,&apos;22&apos;,&apos;26&apos;,&apos;31&apos;,&apos;35&apos;,&apos;39&apos;,&apos;44&apos;,&apos;48&apos;,&apos;52&apos;) then &apos;*&apos; else &apos; &apos; end ) Week_Identifier 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 
LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 
on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) 
on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos;     																				
and  case when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;6.2&apos; 
 then &apos;G&apos; 
 when CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;7.2&apos;
then &apos;1&apos; else &apos;U&apos; end in (&apos;G&apos;,&apos;1&apos;)) TotalSDSRecords
	

on MasterIdentityRows.Run_Number=TotalSDSRecords.Run_Number and
MasterIdentityRows.Run_Type_Code=TotalSDSRecords.Run_Type_Code 
and MasterIdentityRows.Run_Day=TotalSDSRecords.Run_Day 

INNER JOIN
(SELECT distinct Run_Ranking_Week_Details.Run_Number,Rank_Number,
Run_Ranking_Week_Details.Run_Year__Week_Number,
Run_Ranking_Week_Details.TNT_Week__WW_,
Run_Ranking_Week_Details.TNT_Year__YYYY_,Run_Type_Cd 
FROM
(select CM_COSTINGRUN_V01.MRN_ID Run_Number ,T3.RUN_TYPE_CD Run_Type_Cd, 
RANK() over(partition by T3.RUN_TYPE_CD order by CM_COSTINGRUN_V01.MRN_ID desc) as Rank_Number, 
CM_COSTINGRUN_V01.MRN_START_WK_NR Run_Year__Week_Number , 
TNTCALDAYSDIFF_V01.TNT_WK TNT_Week__WW_ , 
TNTCALDAYSDIFF_V01.TNT_YR TNT_Year__YYYY_ 
--min(CM_COSTINGRUN_V01.MRN_START_WK_NR) C1 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T2 
	 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 
on T2.BUS_MODULE_ID = T4.BUS_MODULE_ID 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T3 
on T4.JOB_NM = T3.JOB_NM
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
on T3.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID	   
INNER JOIN  
/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/TNTCALDAYSDIFF_V01 TNTCALDAYSDIFF_V01
ON CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; 
and TNTCALDAYSDIFF_V01.TNT_YR || TNTCALDAYSDIFF_V01.TNT_WK = CM_COSTINGRUN_V01.MRN_START_WK_NR
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T2.BUS_CNTL_MOD_CD = &apos;D&apos; 
and T3.JCL_RUN_DAY_NR in (3, 7)
 group by CM_COSTINGRUN_V01.MRN_ID,
CM_COSTINGRUN_V01.MRN_START_WK_NR , 
CM_COSTINGRUN_V01.MRN_START_WK_NR  , 
TNTCALDAYSDIFF_V01.TNT_WK  , 
TNTCALDAYSDIFF_V01.TNT_YR,T3.RUN_TYPE_CD )   Run_Ranking_Week_Details
where Rank_Number&lt;27)last26runs	  

on last26runs.Run_Number=MasterIdentityRows.Run_Number
and  MasterIdentityRows.Run_Type_Code=last26runs.Run_Type_Cd</attribute>
  <attribute name="creationDate" type="LONG">1567397339940</attribute>
  <attribute name="creatorUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="creatorUserId" type="INTEGER">40103</attribute>
  <attribute name="creatorUserName" type="STRING">x423xjm</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1568612275273</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">40103</attribute>
  <attribute name="lastModifiedUserName" type="STRING">x423xjm</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1567397339940</attribute>
</metadata>