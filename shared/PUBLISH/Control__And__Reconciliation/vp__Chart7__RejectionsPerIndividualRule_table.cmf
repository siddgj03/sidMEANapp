<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:09816cfc-2cfc-4d80-84c8-01e141e93e2a -->
<metadata name="vp_Chart7_RejectionsPerIndividualRule" path="/shared/Publish/Control_And_Reconciliation/vp_Chart7_RejectionsPerIndividualRule" type="TABLE" subtype="SQL_TABLE" changeToken="0" tableType="VIEW">
  <columns>
    <column name="Run_Number" nullable="true">
      <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Run_Type_Cd" nullable="true">
      <datatype type="STRING" minLength="1" maxLength="1"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Number_of_Records" nullable="true">
      <datatype type="INTEGER"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Function_Long_Description" nullable="true">
      <datatype type="STRING" maxLength="255"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Category_Label" nullable="true">
      <datatype type="STRING" minLength="4" trailingSpaces="false"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Run_Day_Sort" nullable="true">
      <datatype type="INTEGER" minValue="-128" maxValue="127"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Sort_ID" nullable="true">
      <datatype type="INTEGER" minValue="-128" maxValue="127"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
  </columns>
  <indexes></indexes>
  <foreignKeys></foreignKeys>
  <security>
    <owner user="x423xjm" domain="tntadtest"/>
    <privilege user="x423xjm" domain="tntadtest" privileges="READ WRITE"/>
  </security>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_MODULE_NM">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="BUS_MODULE_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="PJP_SLR_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_MOD_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_TOTREF_NR" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="FNC_SORT_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="FNC_SHORT_DS" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="FNC_LONG_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="DTE_YRWK_NR" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="COU_ID" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="CM_RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="FNC_SOURCE_CD" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="JCL_RUN_DAY_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="EDW_RECORD_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_PIECE_QT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_CONS_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_KILOS_WT">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
      <element name="EDW_REVENUE_AM">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="MRN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_SEQ_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_UPDT_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_UPDT_USER_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="MRN_LATESTRUN_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRT_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MCF_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_STATUS_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_START_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_END_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ACTUALRUN_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_NM" nullable="false">
        <datatype type="STRING" minLength="40" maxLength="40"/>
      </element>
      <element name="MRN_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
      <element name="CPP_PERIOD_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="ENV_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_OUTPUT_STAT_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="CPP_OUTPUT_VER_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ID_QCFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JOB_JOB_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="JOB_SCHDULED_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="JOB_CONDITIONAL_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="IA_INV_ACC_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="GRP_CD" nullable="false">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JCL_RUN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="JOB_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_RUN_DAY_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_START_TD" nullable="false">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_PROCESS_WK_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_PROCESS_YR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_END_TD">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_RUNTIME_CPU_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_RUNTIME_EPS_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_UPDATE_TS" nullable="false">
        <datatype type="DATETIME"/>
      </element>
    </datatype>
  </dependency>
  <attribute name="SQL" type="STRING">SELECT 
AllRules.Run_Number,
AllRules.Run_Type_Cd,
AllRules.Number_of_Records,
AllRules.Function_Long_Description,
AllRules.Category_Label,
AllRules.Run_Day_Sort,
AllRules.Sort_ID
FROM
(select 
CM_COSTINGRUN_V01.MRN_ID Run_Number ,CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD Run_Type_Cd, 
sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) Number_of_Records , 
cast(&apos;Rule 050 – Product Matrix&apos; as varchar( 255 )) Function_Long_Description , 
CM_CNTRL_METRICS_V01.FNC_SOURCE_CD Function_Source_Code , 
(case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ) Run_Day_Sort ,
 &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label , 
 1 Sort_ID 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where (CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) or CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;6041&apos;, &apos;6045&apos;, &apos;6046&apos;, &apos;6047&apos;, &apos;6048&apos;, &apos;6049&apos;, &apos;60410&apos;, &apos;60411&apos;, &apos;7141&apos;, &apos;7145&apos;, &apos;7146&apos;, &apos;7147&apos;, &apos;7148&apos;, &apos;7149&apos;, &apos;71410&apos;, &apos;71411&apos;)
 group by CM_COSTINGRUN_V01.MRN_ID, CM_CNTRL_METRICS_V01.FNC_SOURCE_CD, (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ),CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD
 
 UNION
select CM_COSTINGRUN_V01.MRN_ID Run_Number ,CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD Run_Type_Cd,
 sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) Number_of_Records , cast(&apos;Rule 140 – Depot&apos; as varchar( 255 )) Function_Long_Description , CM_CNTRL_METRICS_V01.FNC_SOURCE_CD Function_Source_Code , (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then 1 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then 1 else 1 end ) Run_Day_Sort , &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then &apos;Sun&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then &apos;Sun&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label , 2 Sort_ID 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where (CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) or CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;6042&apos;, &apos;6045&apos;, &apos;6048&apos;, &apos;6049&apos;, &apos;60411&apos;, &apos;60412&apos;, &apos;60413&apos;, &apos;60414&apos;, &apos;7142&apos;, &apos;7145&apos;, &apos;7148&apos;, &apos;7149&apos;, &apos;71411&apos;, &apos;71412&apos;, &apos;71413&apos;, &apos;71414&apos;)
 group by CM_COSTINGRUN_V01.MRN_ID, CM_CNTRL_METRICS_V01.FNC_SOURCE_CD, (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ),CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD
 
 UNION
select CM_COSTINGRUN_V01.MRN_ID Run_Number , CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD Run_Type_Cd,
sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) Number_of_Records , cast(&apos;Rule 160 – Domestic Linehaul&apos; as varchar( 255 )) Function_Long_Description , CM_CNTRL_METRICS_V01.FNC_SOURCE_CD Function_Source_Code , (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then 1 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then 1 else 1 end ) Run_Day_Sort , &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then &apos;Sun&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then &apos;Sun&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label , 3 Sort_ID 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where (CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) or CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;6043&apos;, &apos;6046&apos;, &apos;6048&apos;, &apos;60410&apos;, &apos;60411&apos;, &apos;60412&apos;, &apos;60414&apos;, &apos;60415&apos;, &apos;7143&apos;, &apos;7146&apos;, &apos;7148&apos;, &apos;71410&apos;, &apos;71411&apos;, &apos;71412&apos;, &apos;71414&apos;, &apos;71415&apos;)
 group by CM_COSTINGRUN_V01.MRN_ID, CM_CNTRL_METRICS_V01.FNC_SOURCE_CD, (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ),CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD
 
 UNION 
select CM_COSTINGRUN_V01.MRN_ID Run_Number ,CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD Run_Type_Cd,
 sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT * 2) Number_of_Records , cast(&apos;Rule 180 – Country Table&apos; as varchar( 255 )) Function_Long_Description , CM_CNTRL_METRICS_V01.FNC_SOURCE_CD Function_Source_Code , (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then 1 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then 1 else 1 end ) Run_Day_Sort , &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then &apos;Sun&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then &apos;Sun&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label , 4 Sort_ID 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where (CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) or CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;6044&apos;, &apos;6047&apos;, &apos;6049&apos;, &apos;60410&apos;, &apos;60411&apos;, &apos;60413&apos;, &apos;60414&apos;, &apos;60415&apos;, &apos;7144&apos;, &apos;7147&apos;, &apos;7149&apos;, &apos;71410&apos;, &apos;71411&apos;, &apos;71413&apos;, &apos;71414&apos;, &apos;71415&apos;)
 group by CM_COSTINGRUN_V01.MRN_ID, CM_CNTRL_METRICS_V01.FNC_SOURCE_CD, (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ),CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD 

UNION
select CM_COSTINGRUN_V01.MRN_ID Run_Number , CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD Run_Type_Cd,
sum(CM_CNTRL_METRICS_V01.EDW_RECORD_CT) Number_of_Records , cast((case  when CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;60416&apos;, &apos;71416&apos;) then &apos;Other QC Rejections&apos; else &apos;Other Rejections&apos; end ) as varchar( 255 )) Function_Long_Description , CM_CNTRL_METRICS_V01.FNC_SOURCE_CD Function_Source_Code , (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then 1 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then 1 else 1 end ) Run_Day_Sort , &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then &apos;Sun&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then &apos;Sun&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ) Category_Label , (case  when CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;60416&apos;, &apos;71416&apos;) then 5 else 6 end ) Sort_ID 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
 where (CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;, &apos;2&apos;) or CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos;) and CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;60416&apos;, &apos;60417&apos;, &apos;71416&apos;, &apos;71417&apos;)
 group by CM_COSTINGRUN_V01.MRN_ID, cast((case  when CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;60416&apos;, &apos;71416&apos;) then &apos;Other QC Rejections&apos; else &apos;Other Rejections&apos; end ) as varchar( 255 )), CM_CNTRL_METRICS_V01.FNC_SOURCE_CD, (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 else 1 end ), &apos;&apos; || trim(both
 from CM_COSTINGRUN_V01.MRN_ID) || &apos; &apos; || (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then &apos;Tue&apos; else &apos;Sun&apos; end ) || (case  when substring (trim(both
 from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;, &apos;09&apos;, &apos;13&apos;, &apos;18&apos;, &apos;22&apos;, &apos;26&apos;, &apos;31&apos;, &apos;35&apos;, &apos;39&apos;, &apos;44&apos;, &apos;48&apos;, &apos;52&apos;) then &apos;*&apos; else &apos;&apos; end ), (case  when CM_CNTRL_METRICS_DESC_V01.FNC_ID in (&apos;60416&apos;, &apos;71416&apos;) then 5 else 6 end ),CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD
)AllRules

INNER JOIN

(SELECT distinct Run_Ranking_Week_Details.Run_Number,Run_Type_Cd
FROM
(select CM_COSTINGRUN_V01.MRN_ID Run_Number ,T3.RUN_TYPE_CD Run_Type_Cd, 
DENSE_RANK() over(partition by T3.RUN_TYPE_CD order by CM_COSTINGRUN_V01.MRN_ID desc) as Rank_Number
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T2 
	 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 
on T2.BUS_MODULE_ID = T4.BUS_MODULE_ID 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T3 
on T4.JOB_NM = T3.JOB_NM
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
on T3.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID	   
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T2.BUS_CNTL_MOD_CD = &apos;D&apos; 
and ((T3.RUN_TYPE_CD=&apos;G&apos; and T3.JCL_RUN_DAY_NR in (3, 7))or T3.RUN_TYPE_CD=&apos;1&apos;)
)   Run_Ranking_Week_Details
where Rank_Number&lt;27)last26runs

ON last26runs.Run_Number=AllRules.Run_Number
AND last26runs.Run_Type_Cd=AllRules.Run_Type_Cd 


</attribute>
  <attribute name="creationDate" type="LONG">1567507980625</attribute>
  <attribute name="creatorUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="creatorUserId" type="INTEGER">40103</attribute>
  <attribute name="creatorUserName" type="STRING">x423xjm</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1568612276464</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">40103</attribute>
  <attribute name="lastModifiedUserName" type="STRING">x423xjm</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1567507980625</attribute>
</metadata>