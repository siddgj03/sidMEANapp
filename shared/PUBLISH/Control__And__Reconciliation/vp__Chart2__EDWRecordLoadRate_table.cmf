<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:09816cfc-2cfc-4d80-84c8-01e141e93e2a -->
<metadata name="vp_Chart2_EDWRecordLoadRate" path="/shared/Publish/Control_And_Reconciliation/vp_Chart2_EDWRecordLoadRate" type="TABLE" subtype="SQL_TABLE" changeToken="0" tableType="VIEW">
  <columns>
    <column name="Week_Identifier" nullable="true">
      <datatype type="STRING" minLength="3" trailingSpaces="false"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Business_Module_Id" nullable="true">
      <datatype type="STRING" minLength="10" maxLength="10"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="Run_Type_cd" nullable="true">
      <datatype type="STRING" minLength="1" maxLength="1"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
    <column name="EDW_Load_Rate" nullable="true">
      <datatype type="DECIMAL" maxDigits="32" maxFractionalDigits="8"/>
      <security>
        <owner user="x423xjm" domain="tntadtest"/>
      </security>
    </column>
  </columns>
  <indexes></indexes>
  <foreignKeys></foreignKeys>
  <security>
    <owner user="x423xjm" domain="tntadtest"/>
    <privilege user="x423xjm" domain="tntadtest" privileges="READ WRITE SELECT UPDATE INSERT DELETE"/>
  </security>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_MODULE_NM">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="BUS_MODULE_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="PJP_SLR_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_MOD_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="BUS_CNTL_TOTREF_NR" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="FNC_SORT_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="FNC_SHORT_DS" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="FNC_LONG_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="FNC_ID" nullable="false">
        <datatype type="STRING" minLength="20" maxLength="20"/>
      </element>
      <element name="DTE_YRWK_NR" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="COU_ID" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="CM_RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="FNC_SOURCE_CD" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="JCL_RUN_DAY_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="EDW_RECORD_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_PIECE_QT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_CONS_CT">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="EDW_KILOS_WT">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
      <element name="EDW_REVENUE_AM">
        <datatype type="DECIMAL" maxDigits="18" maxFractionalDigits="6"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="MRN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_SEQ_NR" nullable="false">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="MRN_UPDT_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_UPDT_USER_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="MRN_LATESTRUN_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRT_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MCF_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_STATUS_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_START_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_END_WK_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ACTUALRUN_DT">
        <datatype type="DATE"/>
      </element>
      <element name="MRN_NM" nullable="false">
        <datatype type="STRING" minLength="40" maxLength="40"/>
      </element>
      <element name="MRN_DS">
        <datatype type="STRING" maxLength="255"/>
      </element>
      <element name="CPP_PERIOD_ID">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="ENV_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="MRN_OUTPUT_STAT_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="CPP_OUTPUT_VER_NR">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MRN_ID_QCFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_RUN_TYPE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="ACC_RECORD_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="5" maxLength="5"/>
      </element>
      <element name="LNG_ID" nullable="false">
        <datatype type="STRING" minLength="3" maxLength="3"/>
      </element>
      <element name="TAV_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JOB_JOB_DS">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="JOB_SCHDULED_CD" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="JOB_CONDITIONAL_IN" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="BUS_MODULE_ID" nullable="false">
        <datatype type="STRING" minLength="10" maxLength="10"/>
      </element>
      <element name="IA_INV_ACC_ID" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="GRP_CD" nullable="false">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="JCL_RUN_ID" nullable="false">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="JOB_ID" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_RUN_DAY_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="RUN_TYPE_CD" nullable="false">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="JOB_NM" nullable="false">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="JCL_START_TD" nullable="false">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_PROCESS_WK_NR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_PROCESS_YR">
        <datatype type="INTEGER" minValue="-32768" maxValue="32767"/>
      </element>
      <element name="JCL_END_TD">
        <datatype type="DATETIME"/>
      </element>
      <element name="JCL_RUNTIME_CPU_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_RUNTIME_EPS_NR">
        <datatype type="DECIMAL" maxDigits="9" maxFractionalDigits="2"/>
      </element>
      <element name="JCL_UPDATE_TS" nullable="false">
        <datatype type="DATETIME"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/TNTCALDAYSDIFF_V01" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="DTE_DT" nullable="false">
        <datatype type="DATE"/>
      </element>
      <element name="TNT_WK">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
      <element name="TNT_MTH">
        <datatype type="STRING" minLength="2" maxLength="2"/>
      </element>
      <element name="TNT_QTR">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="TNT_YR">
        <datatype type="STRING" minLength="4" maxLength="4"/>
      </element>
      <element name="DAYS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="WKS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="MTHS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="QTRS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="YRS_DIFF">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <attribute name="SQL" type="STRING">select 
Chart1.Week_Identifier,	
Chart1.Business_Module_Id,
Chart1.Run_Type_cd,
--Chart1.Run_Day,
--Chart1.Run_Day_number as Run_Day_Number,
--CM_CNTRL_METRICS_V01.EDW_RECORD_CT as Record_Count,
--SUM(Duration) as Duration ,
cast((cast(CM_CNTRL_METRICS_V01.EDW_RECORD_CT as decimal(32,8))/sum(cast(Duration as decimal(32,8))))as decimal(32,8)) as EDW_Load_Rate
--cast((cast(CM_CNTRL_METRICS_V01.EDW_RECORD_CT as decimal(32,8))/cast(SUM(Duration)as decimal(32,8)))as decimal(32,8)) as EDW_Load_Rate

from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_DESC_V01 CM_CNTRL_METRICS_DESC_V01 
LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_CNTRL_METRICS_V01 CM_CNTRL_METRICS_V01 
on CM_COSTINGRUN_V01.MRN_START_WK_NR = CM_CNTRL_METRICS_V01.DTE_YRWK_NR) 
on CM_CNTRL_METRICS_DESC_V01.FNC_ID = CM_CNTRL_METRICS_V01.FNC_ID
INNER JOIN
		
(SELECT 
 distinct SubQ1.MRN_ID as Run_Number,
SubQ1.BUS_MODULE_NM Business_Module_Name,
SubQ1.BUS_MODULE_ID Business_Module_Id,
SubQ1.Run_Type_cd,			   
SubQ1.Run_Day,	
case when seconds/100&lt;1 then seconds/60+cast(MOD(seconds,60) as decimal(9,2))/100 else seconds/60 end as Duration,        
SubQ1.JCL_RUN_DAY_NR Run_Day_number,
SubQ1.Week_Identifier 
 FROM
(select distinct 
MAX(CM_COSTINGRUN_V01.MRN_ID)Report_Run_Number
,T2.RUN_TYPE_CD Run_Type_Cd
,T2.JCL_RUN_DAY_NR
 from ((/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T3 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 on T3.BUS_MODULE_ID = T4.BUS_MODULE_ID) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T2 on T4.JOB_NM = T2.JOB_NM) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 on T2.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T3.BUS_CNTL_MOD_CD = &apos;D&apos; 
and T2.JCL_RUN_DAY_NR in (3, 7)
group  by T2.RUN_TYPE_CD  ,T2.JCL_RUN_DAY_NR) Latestrunnumbr
inner join 			  
(select distinct --CM_COSTINGRUN_V01.MRN_ID Run_Number , 
min(T2.JCL_RUN_DAY_NR) Run_Day_Number_ET,
CM_COSTINGRUN_V01.MRN_ID Run_Number,
T2.RUN_TYPE_CD Run_Type_Cd 
 from ((/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T3 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 on T3.BUS_MODULE_ID = T4.BUS_MODULE_ID) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T2 on T4.JOB_NM = T2.JOB_NM) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 on T2.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T3.BUS_CNTL_MOD_CD = &apos;D&apos;  and T2.JCL_RUN_DAY_NR in (3, 7) 
group by  CM_COSTINGRUN_V01.MRN_ID,
T2.RUN_TYPE_CD)latestrunday
on 	   Latestrunnumbr.Report_Run_Number   =latestrunday.Run_Number
and   Latestrunnumbr.Run_Type_Cd   =latestrunday.Run_Type_Cd   
inner join
(select distinct  
CM_COSTINGRUN_V01.MRN_ID Report_Run_Number ,
(case  when T2.JCL_RUN_DAY_NR = 7 then &apos;Sunday&apos; when T2.JCL_RUN_DAY_NR = 3 then &apos;Tuesday&apos; else &apos;Unknown&apos; end ) Report_Run_Day , 
T2.JCL_RUN_DAY_NR Run_Day_Number__ET_ ,
T2.RUN_TYPE_CD as Run_Type_Cd 
from ((/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T3 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 on T3.BUS_MODULE_ID = T4.BUS_MODULE_ID) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T2 on T4.JOB_NM = T2.JOB_NM) 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 on T2.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID
where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T3.BUS_CNTL_MOD_CD = &apos;D&apos; 
	and T2.JCL_RUN_DAY_NR in (3, 7))RunTypeDetails
on 	  RunTypeDetails.Report_Run_Number  =Latestrunnumbr.Report_Run_Number
and    RunTypeDetails.Run_Day_Number__ET_= latestrunday.Run_Day_Number_ET
and  RunTypeDetails.Run_Type_Cd  =Latestrunnumbr.Run_Type_Cd  
INNER JOIN
(select distinct CM_COSTINGRUN_V01.MRN_ID,
 T2.BUS_MODULE_NM,
 T2.BUS_MODULE_ID,
 T3.RUN_TYPE_CD Run_Type_cd,
cast(cast(cast((T3.JCL_END_TD-T3.JCL_START_TD) as interval  SECOND(6)) as varchar)as integer) seconds,				   
(case T3.JCL_RUN_DAY_NR when 3 then &apos;Tuesday&apos; when 7 then &apos;Sunday&apos; else &apos;Unknown&apos; end ) Run_Day,
T3.JCL_RUN_DAY_NR,
&apos;  &apos;||trim(both from CM_COSTINGRUN_V01.MRN_ID)||
(case  when substring (trim(both from CM_COSTINGRUN_V01.MRN_ID),3,2) in (&apos;05&apos;,&apos;09&apos;,&apos;13&apos;,&apos;18&apos;,&apos;22&apos;,&apos;26&apos;,&apos;31&apos;,&apos;35&apos;,&apos;39&apos;,&apos;44&apos;,&apos;48&apos;,&apos;52&apos;) then &apos;*&apos; else &apos; &apos; end ) Week_Identifier
 from ((/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T2 
 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T5 on T2.BUS_MODULE_ID = T5.BUS_MODULE_ID) 
 LEFT OUTER JOIN (/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T3 
 INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_RUN_TYPE_V01 CM_RUN_TYPE_V01 
 on T3.RUN_TYPE_CD = CM_RUN_TYPE_V01.ACC_RECORD_TYPE_CD 
 and CM_RUN_TYPE_V01.LNG_ID = &apos;EN&apos;) on T5.JOB_NM = T3.JOB_NM) 
 LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
 on T3.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T2.BUS_CNTL_MOD_CD = &apos;D&apos; 
and T3.JCL_RUN_DAY_NR in (3,7)

) SubQ1
on SubQ1.JCL_RUN_DAY_NR =   latestrunday.Run_Day_Number_ET
and SubQ1.Run_Type_cd =   latestrunday.Run_Type_cd	
inner join
(SELECT distinct Run_Ranking_Week_Details.Run_Number,Run_Type_Cd 
FROM
(select CM_COSTINGRUN_V01.MRN_ID Run_Number ,T3.RUN_TYPE_CD Run_Type_Cd, 
DENSE_RANK() over(partition by T3.RUN_TYPE_CD order by CM_COSTINGRUN_V01.MRN_ID desc) as Rank_Number
--min(CM_COSTINGRUN_V01.MRN_START_WK_NR) C1 
 from /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_BUS_MODULE_V01 T2 
	 
INNER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_PROFILE_V01 T4 
on T2.BUS_MODULE_ID = T4.BUS_MODULE_ID 
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_SCH_JOB_TIMES_V01 T3 
on T4.JOB_NM = T3.JOB_NM
LEFT OUTER JOIN /shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/CM_COSTINGRUN_V01 CM_COSTINGRUN_V01 
on T3.JCL_RUN_ID = CM_COSTINGRUN_V01.MRN_ID	   
INNER JOIN  
/shared/Source/EDW/CostModelling/PRODCOSTMDLG_P/TNTCALDAYSDIFF_V01 TNTCALDAYSDIFF_V01
ON CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; 
and TNTCALDAYSDIFF_V01.TNT_YR || TNTCALDAYSDIFF_V01.TNT_WK = CM_COSTINGRUN_V01.MRN_START_WK_NR
 where CM_COSTINGRUN_V01.MRT_ID = &apos;A&apos; and T2.BUS_CNTL_MOD_CD = &apos;D&apos; 
and T3.JCL_RUN_DAY_NR in (3, 7)
)   Run_Ranking_Week_Details
where Rank_Number&lt;27)last26runs
on 	 last26runs.Run_Number = SubQ1.MRN_ID
and  last26runs.Run_Type_Cd=Latestrunnumbr.Run_Type_Cd

) Chart1
on Chart1.Run_Number = CM_COSTINGRUN_V01.MRN_ID
and Chart1.Run_Day_Number =  (case  when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;1&apos; then 7 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;2&apos; then 3 when CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; then 7 else 7 end )
and Chart1.Run_type_Cd=(CASE WHEN CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;G&apos; 
 and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD in (&apos;1&apos;,&apos;2&apos;) 
 and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;6.2&apos; THEN &apos;G&apos;
 WHEN  CM_CNTRL_METRICS_V01.CM_RUN_TYPE_CD = &apos;1&apos; 
 and CM_CNTRL_METRICS_V01.FNC_SOURCE_CD = &apos;3&apos; 
 and CM_CNTRL_METRICS_DESC_V01.FNC_SHORT_DS = &apos;7.2&apos; THEN &apos;1&apos;
 ELSE &apos;U&apos; END)	  
where Chart1.Business_Module_Id=&apos;0800EDW&apos; 
group by Chart1.Week_Identifier,	
Chart1.Business_Module_Id,
Chart1.Run_Type_cd,
--Chart1.Run_Day,
--Chart1.Run_Day_number ,
CM_CNTRL_METRICS_V01.EDW_RECORD_CT </attribute>
  <attribute name="creationDate" type="LONG">1567146072126</attribute>
  <attribute name="creatorUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="creatorUserId" type="INTEGER">40103</attribute>
  <attribute name="creatorUserName" type="STRING">x423xjm</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1568612428801</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">tntadtest</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">40103</attribute>
  <attribute name="lastModifiedUserName" type="STRING">x423xjm</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1567146072126</attribute>
</metadata>